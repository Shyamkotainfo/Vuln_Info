from pymongo import MongoClient
from pymongo.errors import ConnectionFailure
from .config import Config

class MongoManager:
    _client = None

    @classmethod
    def get_client(cls):
        if cls._client is None:
            try:
                cls._client = MongoClient(Config.MONGO_URI)
                # verify connection
                cls._client.admin.command('ping')
                print("Connected to MongoDB successfully.")
            except ConnectionFailure as e:
                print(f"Could not connect to MongoDB: {e}")
                raise
        return cls._client

    @classmethod
    def get_db(cls, db_name):
        client = cls.get_client()
        return client[db_name]

    @classmethod
    def get_bronze_db(cls):
        return cls.get_db(Config.DB_BRONZE)

    @classmethod
    def get_silver_db(cls):
        return cls.get_db(Config.DB_SILVER)

    @classmethod
    def get_gold_db(cls):
        return cls.get_db(Config.DB_GOLD)
