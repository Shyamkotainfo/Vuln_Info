import requests
import json
from datetime import datetime

class NVDExtractor:
    def __init__(self):
        # Placeholder URL, user needs to configure real one or use local file
        self.base_url = "https://services.nvd.nist.gov/rest/json/cves/2.0"
    
    def extract_from_api(self, limit=100):
        try:
            response = requests.get(self.base_url, params={'resultsPerPage': limit}, timeout=30)
            response.raise_for_status()
            return response.json().get('vulnerabilities', [])
        except Exception as e:
            print(f"Error extracting NVD data: {e}")
            return []

    def extract_from_file(self, file_path):
        with open(file_path, 'r') as f:
            data = json.load(f)
            return data.get('vulnerabilities', [])
