from ...base import BaseLoader
from ....core.config import Config

class MetasploitLoader(BaseLoader):
    def __init__(self):
        super().__init__(Config.COLLECTION_METASPLOIT, key_field="fullname")

    def transform(self, item):
        doc = {
            "title": item.get("title"),
            "name": item.get("name"),
            "fullname": item.get("fullname"),
            "aliases": item.get("aliases"),
            "rank": item.get("rank"),
            "disclosure_date": item.get("disclosure_date"),
            "type": item.get("type"),
            "platform": item.get("platform"),
            "arch": item.get("arch"),
            "rport": item.get("rport"),
            "autofilter_ports": item.get("autofilter_ports"),
            "autofilter_services": item.get("autofilter_services"),
            "targets": item.get("targets"),
            "mod_time": item.get("mod_time"),
            "path": item.get("path"),
            "is_install_path": item.get("is_install_path"),
            "ref_name": item.get("ref_name"),
            "check": item.get("check"),
            "post_auth": item.get("post_auth"),
            "default_credential": item.get("default_credential"),
            "notes": item.get("notes"),
            "session_types": item.get("session_types"),
            "needs_cleanup": item.get("needs_cleanup"),
            "actions": item.get("actions"),
            "author": item.get("author"), 
            "description": item.get("description"),
            "references": item.get("references"),
            # ingested_at added by base
        }
        return doc
