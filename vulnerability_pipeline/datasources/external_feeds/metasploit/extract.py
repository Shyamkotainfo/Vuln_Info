import csv
import os

class MetasploitExtractor:
    def __init__(self, file_path=None):
        # Default to a local file if not provided
        self.file_path = file_path or "metasploit_modules.csv"

    def extract(self):
        if not os.path.exists(self.file_path):
            print(f"Metasploit data file not found at {self.file_path}")
            return []
            
        try:
            with open(self.file_path, 'r', encoding='utf-8') as f:
                reader = csv.DictReader(f)
                return list(reader)
        except Exception as e:
            print(f"Error extracting Metasploit data: {e}")
            return []
