from ...base import BaseLoader
from ....core.config import Config

class ExploitDBLoader(BaseLoader):
    def __init__(self):
        super().__init__(Config.COLLECTION_EXPLOIT, key_field="id")

    def transform(self, item):
        doc = {
            "id": item.get("id"),
            "file": item.get("file"),
            "description": item.get("description"),
            "date_published": item.get("date_published"),
            "author": item.get("author"),
            "type": item.get("type"),
            "platform": item.get("platform"),
            "port": item.get("port"),
            # ingested_at added by base
        }
        return doc
