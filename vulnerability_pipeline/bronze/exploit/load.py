from vulnerability_pipeline.core.base_etl import BaseLoader
from vulnerability_pipeline.core.config import Config

class ExploitDBLoader(BaseLoader):
    def __init__(self):
        super().__init__(Config.COLLECTION_EXPLOIT, key_field="id")

    def transform(self, item):
        doc = {
            "id": item.get("id"),
            "file": item.get("file"),
            "description": item.get("description"),
            "date_published": item.get("date_published"),
            "author": item.get("author"),
            "type": item.get("type"),
            "platform": item.get("platform"),
            "port": item.get("port"),
            "screenshot_url": item.get("screenshot_url"),
            "verified": item.get("verified"),
            "source_url": item.get("source_url"),
            "application_url": item.get("application_url"),
            "codes": item.get("codes"),
            "tags": item.get("tags"),
            # ingested_at added by base
        }
        return doc
